<?xml version="1.0" encoding="utf-8"?>
<statRules version="1.0">
  <!-- Regel 1: happiness <= 0.50 => halve yield (alle ressourcer) -->
  <rule id="happiness_low" enabled="true">
    <title lang="da">Lav trivsel — reducer produktion</title>
    <expr>happiness <= 0.50</expr>
    <stage>2</stage>
    <scope>player</scope>
    <buff>
      <kind>res</kind>
      <mode>yield</mode>
      <op>mult</op>
      <amount>-50</amount>
      <scopeTarget>all</scopeTarget>
      <source>stat.happiness_low</source>
    </buff>
    <refreshPolicy>refresh</refreshPolicy>
  </rule>

  <!-- Regel 2: happiness > 0.80 => double yield -->
  <rule id="happiness_high" enabled="true">
    <title lang="da">Høj trivsel — øget produktion</title>
    <expr>happiness &gt; 0.80</expr>
    <stage>2</stage>
    <scope>player</scope>
    <buff>
      <kind>res</kind>
      <mode>yield</mode>
      <op>mult</op>
      <amount>100</amount>
      <scopeTarget>all</scopeTarget>
      <source>stat.happiness_high</source>
    </buff>
    <refreshPolicy>refresh</refreshPolicy>
  </rule>

  <!-- Regel 3: popularity < 0.50 => byggetid +25% -->
  <rule id="popularity_low_speed_penalty" enabled="true">
    <title lang="da">Lav popularitet — langsommere byggerier</title>
    <expr>popularity &lt; 0.50</expr>
    <stage>2</stage>
    <scope>player</scope>
    <buff>
      <kind>speed</kind>
      <op>mult</op>
      <amount>-25</amount> <!-- -25% speed => 1.25x varighed -->
      <appliesTo>buildings</appliesTo>
      <actions>all</actions>
      <source>stat.popularity_low</source>
      <mode>speed</mode>
    </buff>
    <refreshPolicy>refresh</refreshPolicy>
  </rule>

  <!-- Regel 4: (deaktiveret) regn halverer korn-yield -->
  <rule id="weather_rain_crop_penalty" enabled="false">
    <title lang="da">Regn — korn påvirkes</title>
    <expr>weather == 'rain'</expr>
    <stage>2</stage>
    <scope>player</scope>
    <buff>
      <kind>res</kind>
      <mode>yield</mode>
      <op>mult</op>
      <amount>-50</amount>
      <scopeTarget>res.wheat,res.oat,res.maize</scopeTarget>
      <source>stat.weather_rain</source>
    </buff>
    <refreshPolicy>refresh</refreshPolicy>
  </rule>

  <!-- Regel 5: crimePercent > 0.50 => money yield -10% -->
  <rule id="crime_money_penalty" enabled="true">
    <title lang="da">Høj kriminalitet — mindre penge</title>
    <expr>crimePercent &gt; 0.50</expr>
    <stage>2</stage>
    <scope>player</scope>
    <buff>
      <kind>res</kind>
      <mode>yield</mode>
      <op>mult</op>
      <amount>-10</amount>
      <scopeTarget>res.money</scopeTarget>
      <source>stat.crime_money_penalty</source>
    </buff>
    <refreshPolicy>refresh</refreshPolicy>
  </rule>

  <!-- Regel 6: (deaktiveret) fire overload -> durability x2 -->
  <rule id="fire_overload_durability" enabled="false">
    <title lang="da">Brandsårbarhed (midlertidigt deaktiveret)</title>
    <expr>useFire/fireCapacity &gt; 1.0</expr>
    <stage>2</stage>
    <scope>player</scope>
    <effect>
      <type>durability_multiplier</type>
      <multiplier>2.0</multiplier>
      <source>stat.fire_overload</source>
    </effect>
    <refreshPolicy>refresh</refreshPolicy>
  </rule>
</statRules>