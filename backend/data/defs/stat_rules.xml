<?xml version="1.0" encoding="utf-8"?>
<statRules version="1.0">
  <!-- Rule 1: happiness <= 0.50 => halve yield (all resources) -->
  <rule id="happiness_low" enabled="true">
    <title lang="da">Lav trivsel — reducer produktion</title>
    <expr>happiness <= 0.50</expr>
    <stage>2</stage>
    <scope>player</scope>
    <buff>
      <kind>res</kind>
      <mode>yield</mode>         <!-- kun påvirke yield -->
      <op>mult</op>
      <amount>-50</amount>       <!-- pct: -50 => 50% (se buffs.php logic) -->
      <scopeTarget>all</scopeTarget>
      <source>stat.happiness_low</source>
    </buff>
    <refreshPolicy>refresh</refreshPolicy>
    <ui>
      <message lang="da">Happiness er lav — alle ressource‑yields reduceres.</message>
    </ui>
  </rule>

  <!-- Rule 2: happiness > 0.80 => double yield (all resources) -->
  <rule id="happiness_high" enabled="true">
    <title lang="da">Høj trivsel — øget produktion</title>
    <expr>happiness &gt; 0.80</expr>
    <stage>2</stage>
    <scope>player</scope>
    <buff>
      <kind>res</kind>
      <mode>yield</mode>
      <op>mult</op>
      <amount>100</amount>       <!-- pct: +100 => 2x -->
      <scopeTarget>all</scopeTarget>
      <source>stat.happiness_high</source>
    </buff>
    <refreshPolicy>refresh</refreshPolicy>
    <ui>
      <message lang="da">Høj happiness — alle ressource‑yields forøges.</message>
    </ui>
  </rule>

  <!-- Rule 3: popularity < 0.50 => build times increase by 25% -->
  <rule id="popularity_low_speed_penalty" enabled="true">
    <title lang="da">Lav popularitet — langsommere byggerier</title>
    <expr>popularity &lt; 0.50</expr>
    <stage>2</stage>
    <scope>player</scope>
    <buff>
      <kind>speed</kind>
      <op>mult</op>
      <amount>-25</amount>         <!-- pct: -25 -> dur multiplier 1.25 i apply_speed_buffs -->
      <appliesTo>buildings</appliesTo>
      <actions>build</actions>
      <source>stat.popularity_low</source>
      <mode>speed</mode>
    </buff>
    <refreshPolicy>refresh</refreshPolicy>
    <ui>
      <message lang="da">Lav popularity — byggevarigheder øges.</message>
    </ui>
  </rule>

  <!-- Rule 4: (commented out / disabled) rainy weather halves certain crops -->
  <rule id="weather_rain_crop_penalty" enabled="false">
    <title lang="da">Regn — korn påvirkes</title>
    <expr>weather == 'rain'</expr>
    <stage>2</stage>
    <scope>player</scope>
    <buff>
      <kind>res</kind>
      <mode>yield</mode>
      <op>mult</op>
      <amount>-50</amount>
      <scopeTarget>res.wheat,res.oat,res.maize</scopeTarget>
      <source>stat.weather_rain</source>
    </buff>
    <refreshPolicy>refresh</refreshPolicy>
  </rule>

  <!-- Rule 5: crime percent > 0.50 => money yield -10% -->
  <rule id="crime_money_penalty" enabled="true">
    <title lang="da">Høj kriminalitet — mindre penge</title>
    <expr>crimePercent &gt; 0.50</expr>
    <stage>2</stage>
    <scope>player</scope>
    <buff>
      <kind>res</kind>
      <mode>yield</mode>
      <op>mult</op>
      <amount>-10</amount>
      <scopeTarget>res.money</scopeTarget>
      <source>stat.crime_money_penalty</source>
    </buff>
    <refreshPolicy>refresh</refreshPolicy>
    <ui>
      <message lang="da">Høj kriminalitet — money yield reduceres.</message>
    </ui>
  </rule>

  <!-- Rule 6: (commented out) fire usage > capacity -> double durability damage -->
  <rule id="fire_overload_durability" enabled="false">
    <title lang="da">Brandsårbarhed (midlertidigt deaktiveret)</title>
    <expr>useFire/fireCapacity &gt; 1.0</expr>
    <stage>2</stage>
    <scope>player</scope>
    <effect>
      <type>durability_multiplier</type>
      <multiplier>2.0</multiplier>
      <source>stat.fire_overload</source>
    </effect>
    <refreshPolicy>refresh</refreshPolicy>
  </rule>
</statRules>